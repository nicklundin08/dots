version: "3"

vars:
  XDG_CONFIG_HOME: '{{default "~" .XDG_CONFIG_HOME}}'
  DOTS_DIR: '{{.XDG_CONFIG_HOME}}/DOTS'

      
tasks:
  default:
    summary: |
      TODO: write a summary
    desc: |
      TODO: write a desc
    cmds:
      - task --list-all
  
  increment:
    cmds: 
      - |
      pre-commit && \
              git add . && \
              cz commit && \
              hm.rebuild && \
              git push && \
              git switch $(hm.show_host_for_git) && \
              git merge --ff main && \
              git push && \
              git switch main

  pull:
    cmds: 
      - |
        git switch $(hm.show_host_for_git) && \
                git merge --ff main && \
                hm.rebuild && \
                git push && \
                git switch main && \
                exec bash

  rebuild:
    cmds: 
      - echo "TODO!"

  create_branch_for_host:
    cmds:
      - |
        git branch $(task show_host_for_git)
        git push -u origin $(show_host_for_git)

  show_host_for_git:
    cmds:
      # git dont like @ symbols
      - echo "hm/$(whoami)-$(hostname)"

  show_host_for_nix:
    cmds:
      - echo "$(whoami)@$(hostname)";

